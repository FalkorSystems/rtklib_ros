#!/usr/bin/env python
import roslib
roslib.load_manifest( 'rtk_node' )

from sensor_msgs.msg import *
import re

class RtkNode:
    def __init__( self ):
        self.navsatfix_pub = rospy.Publisher( "fix", NavSatFix )
        self.navsatfix_vel_pub = rospy.Publisher( "fix_velocity", Vector3Stamped )
        self.world_frame = rospy.get_param( "~world_frame", "/nav" )
        self.position_covariance = [0]*9

        self.navsatfix_msg = NavSatFix()
        self.navsatfix_vel_msg = Vector3Stamped()
    
    def process_line( self, line ):
        info = re.match( line,
                         "(\d+)" + "\w+" +   # week
                         "(\d+)" + "\w+" +   # tow
                         "(\d+\.+\d+)" + "\w+" + # lat
                         "(\d+\.+\d+)" + "\w+" + # long
                         "(\d+\.+\d+)" + "\w+" + # height
                         ".*" )
        if info == None:
            raise Exception( "invalid line: " + line )

        week = info.group(0)
        tow = info.group(1)
        lat = info.group(2)
        long = info.group(3)
        height = info.group(4)

